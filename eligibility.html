<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>Fast Loan Eligibility Check Kenya | Apply in 5 Minutes | Techspace Finance</title>
    <meta name="description" content="Check your loan eligibility instantly in Kenya. Get KES 3,500-35,000 personal loans via M-Pesa. Fast approval, flexible repayment, no hidden fees. Apply now!">
    <meta name="keywords" content="instant loans Kenya, M-PESA loans, check loan eligibility, emergency loans Kenya, personal loans Nairobi, fast cash loans, mobile loans Kenya, unsecured loans">
    <meta name="author" content="Techspace Finance">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://techspacefinance.co.ke/eligibility">
    
    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Fast Loan Eligibility Check Kenya | Techspace Finance">
    <meta property="og:description" content="Check your loan eligibility instantly. Get KES 3,500-35,000 via M-Pesa. Fast approval, flexible repayment.">
    <meta property="og:url" content="https://techspacefinance.co.ke/eligibility">
    <meta property="og:site_name" content="Techspace Finance">
    <meta property="og:locale" content="en_KE">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Fast Loan Eligibility Check Kenya | Techspace Finance">
    <meta name="twitter:description" content="Check your loan eligibility instantly. Get KES 3,500-35,000 via M-Pesa. Fast approval.">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2322c55e'><path d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.31-8.86c-1.77-.45-2.34-.94-2.34-1.67 0-.84.79-1.43 2.1-1.43 1.38 0 1.9.66 1.94 1.64h1.71c-.05-1.34-.87-2.57-2.49-2.97V5H10.9v1.69c-1.51.32-2.72 1.3-2.72 2.81 0 1.79 1.49 2.69 3.66 3.21 1.95.46 2.34 1.15 2.34 1.87 0 .53-.39 1.39-2.1 1.39-1.6 0-2.23-.72-2.32-1.64H8.04c.1 1.7 1.36 2.66 2.86 2.97V19h2.34v-1.67c1.52-.29 2.72-1.16 2.73-2.77-.01-2.2-1.9-2.96-3.66-3.42z'/></svg>">
    
    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="preconnect" href="https://www.google-analytics.com">
    <link rel="preconnect" href="https://connect.facebook.net">
    
    <!-- Google Analytics 4 (GA4) - Replace G-XXXXXXXXXX with your actual Measurement ID -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-XXXXXXXXXX');
    </script>
    
    <!-- Meta Pixel (Facebook Pixel) - Replace YOUR_PIXEL_ID with your actual Pixel ID -->
    <script>
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', 'YOUR_PIXEL_ID');
        fbq('track', 'PageView');
    </script>
    <noscript>
        <img height="1" width="1" style="display:none"
             src="https://www.facebook.com/tr?id=YOUR_PIXEL_ID&ev=PageView&noscript=1"/>
    </noscript>
    
    <!-- Schema.org Structured Data (FinancialProduct + LocalBusiness + AggregateRating) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FinancialService",
      "name": "Techspace Finance",
      "description": "Fast and reliable personal loans in Kenya with instant M-Pesa disbursement",
      "url": "https://techspacefinance.onrender.com",
      "logo": "https://techspacefinance.onrender.com/logo.png",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "Nairobi",
        "addressCountry": "KE"
      },
      "geo": {
        "@type": "GeoCoordinates",
        "latitude": -1.286389,
        "longitude": 36.817223
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.7",
        "reviewCount": "2847",
        "bestRating": "5",
        "worstRating": "1"
      },
      "review": [
        {
          "@type": "Review",
          "author": {
            "@type": "Person",
            "name": "Mary Wanjiku"
          },
          "datePublished": "2025-03-15",
          "reviewBody": "Quick loan approval and M-Pesa disbursement within minutes. Very professional service!",
          "reviewRating": {
            "@type": "Rating",
            "ratingValue": "5",
            "bestRating": "5"
          }
        },
        {
          "@type": "Review",
          "author": {
            "@type": "Person",
            "name": "John Kamau"
          },
          "datePublished": "2025-02-28",
          "reviewBody": "Transparent terms and flexible repayment options. Highly recommended for emergency loans.",
          "reviewRating": {
            "@type": "Rating",
            "ratingValue": "5",
            "bestRating": "5"
          }
        },
        {
          "@type": "Review",
          "author": {
            "@type": "Person",
            "name": "Grace Achieng"
          },
          "datePublished": "2025-01-20",
          "reviewBody": "Easy application process and reasonable interest rates. Great customer support.",
          "reviewRating": {
            "@type": "Rating",
            "ratingValue": "4",
            "bestRating": "5"
          }
        }
      ],
      "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "Personal Loan Products",
        "itemListElement": [
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "FinancialProduct",
              "name": "Personal Loan Kenya",
              "description": "Fast personal loans from KES 3,500 to KES 35,000"
            },
            "price": "3500-35000",
            "priceCurrency": "KES"
          }
        ]
      }
    }
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            color: #1f2937;
            background: #f9fafb;
            min-height: 100vh;
        }

        .navbar {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            padding: 1rem 2rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .hamburger {
            display: none;
            cursor: pointer;
            flex-direction: column;
            gap: 4px;
        }

        .hamburger span {
            width: 25px;
            height: 3px;
            background: white;
            border-radius: 2px;
        }

        .container {
            max-width: 600px;
            margin: 3rem auto;
            padding: 2rem;
        }

        .form-card {
            background: white;
            border-radius: 12px;
            padding: 2.5rem;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            animation: fadeInUp 0.5s ease-out;
        }

        h1 {
            text-align: center;
            color: #1f2937;
            margin-bottom: 2rem;
            font-size: 2rem;
        }

        .progress-steps {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            background: #e5e7eb;
            color: #6b7280;
            transition: all 0.3s ease;
        }

        .step.active .step-number {
            background: #d946ef;
            color: white;
        }

        .step.completed .step-number {
            background: #22c55e;
            color: white;
        }

        .step-label {
            font-size: 0.9rem;
            color: #6b7280;
            text-align: center;
        }

        .step.active .step-label {
            color: #d946ef;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #1f2937;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 0.875rem;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #22c55e;
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
        }

        .form-group input.error,
        .form-group select.error {
            border-color: #ef4444;
        }

        .error-message {
            color: #ef4444;
            font-size: 0.875rem;
            margin-top: 0.25rem;
            display: none;
        }

        .button-group {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn {
            flex: 1;
            padding: 1rem;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }

        .btn-back {
            background: white;
            color: #6b7280;
            border: 1px solid #e5e7eb;
        }

        .btn-back:hover {
            background: #f9fafb;
        }

        .btn-next {
            background: #22c55e;
            color: white;
        }

        .btn-next:hover:not(:disabled) {
            background: #16a34a;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
        }

        .btn-next:disabled {
            background: #d1d5db;
            cursor: not-allowed;
        }

        .btn-submit {
            background: #d946ef;
            color: white;
        }

        .btn-submit:hover:not(:disabled) {
            background: #c026d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(217, 70, 239, 0.3);
        }

        .success-message {
            text-align: center;
            color: #16a34a;
            animation: fadeInUp 0.5s ease-out;
        }

        .success-message p {
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        .spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #22c55e;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }

        .form-step {
            display: none;
            animation: fadeIn 0.3s ease-out;
        }

        .form-step.active {
            display: block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .progress-bar-container {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 10px;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #22c55e 0%, #16a34a 100%);
            border-radius: 10px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .progress-text {
            text-align: center;
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 1rem;
        }

        .checkbox-group {
            margin-bottom: 1.5rem;
        }

        .checkbox-group label {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            cursor: pointer;
            font-weight: normal;
            color: #4b5563;
            font-size: 0.9rem;
        }

        .checkbox-group input[type="checkbox"] {
            margin-top: 0.2rem;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            max-width: 400px;
            width: 90%;
            text-align: center;
            animation: fadeInUp 0.3s ease-out;
        }

        .modal-progress {
            margin: 1.5rem 0;
        }

        .modal-progress-text {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }

        .checkmark-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 1rem;
            animation: scaleIn 0.5s ease-out;
        }

        @keyframes scaleIn {
            0% {
                transform: scale(0);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
            }
        }

        .notification-box {
            position: fixed;
            top: 80px;
            right: 20px;
            max-width: 400px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            padding: 1rem 1.5rem;
            display: none;
            animation: slideInRight 0.3s ease-out;
            z-index: 1001;
        }

        .notification-box.show {
            display: block;
        }

        .notification-box.error {
            border-left: 4px solid #ef4444;
        }

        .notification-box.success {
            border-left: 4px solid #22c55e;
        }

        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .notification-title {
            font-weight: 600;
            color: #1f2937;
        }

        .notification-close {
            cursor: pointer;
            color: #6b7280;
            font-size: 1.2rem;
            line-height: 1;
        }

        .notification-message {
            color: #6b7280;
            font-size: 0.9rem;
        }

        .notification-list {
            margin-top: 0.5rem;
            padding-left: 1.2rem;
        }

        .notification-list li {
            color: #ef4444;
            font-size: 0.85rem;
            margin-bottom: 0.25rem;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .form-group input.valid,
        .form-group select.valid {
            border-color: #22c55e;
        }

        .success-icon {
            color: #22c55e;
            font-size: 0.9rem;
            margin-left: 0.5rem;
        }

        .processing-step {
            margin: 0.75rem 0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.95rem;
            color: #6b7280;
        }

        .processing-step.active {
            color: #1f2937;
            font-weight: 500;
        }

        .processing-step.completed {
            color: #22c55e;
        }

        .step-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid #d1d5db;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .processing-step.active .step-icon {
            border-color: #22c55e;
        }

        .processing-step.active .step-icon::after {
            content: '';
            width: 8px;
            height: 8px;
            background: #22c55e;
            border-radius: 50%;
            animation: pulse 1s infinite;
        }

        .processing-step.completed .step-icon {
            background: #22c55e;
            border-color: #22c55e;
        }

        .processing-step.completed .step-icon::after {
            content: '✓';
            color: white;
            font-size: 12px;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
                margin: 2rem auto;
            }

            .form-card {
                padding: 1.5rem;
            }

            h1 {
                font-size: 1.5rem;
            }

            .progress-steps {
                gap: 1.5rem;
            }

            .step-label {
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <div class="nav-container">
            <a href="index.html" class="logo" aria-label="Techspace Finance - Return to homepage">
                <svg width="36" height="36" viewBox="0 0 64 64"
     xmlns="http://www.w3.org/2000/svg"
     role="img" aria-labelledby="logoTitle logoDesc">
  <title id="logoTitle">Techspace Finance Logo</title>
  <desc id="logoDesc">A green shield with a bank building symbol representing financial security and trust</desc>
  <!-- Outer shield shape -->
  <path d="M32 4 L50 12 V28 C50 42 39 51 32 56 C25 51 14 42 14 28 V12 Z"
        fill="white" opacity="0.95"/>
  
  <!-- Roof of the bank -->
  <polygon points="20,22 44,22 32,14" fill="#22c55e"/>
  
  <!-- Pillars -->
  <rect x="22.5" y="26" width="4" height="12" rx="0.8" fill="#22c55e"/>
  <rect x="29.5" y="26" width="4" height="12" rx="0.8" fill="#22c55e"/>
  <rect x="36.5" y="26" width="4" height="12" rx="0.8" fill="#22c55e"/>
  
  <!-- Bank base (step) -->
  <rect x="20" y="40" width="24" height="3" rx="1" fill="#22c55e"/>
</svg>
                Techspace Finance
            </a>
        </div>
    </nav>

    <div class="container">
        <div class="form-card">
            <h1 id="formTitle" role="heading" aria-level="1">Check Your Eligibility</h1>
            
            <div class="progress-text" aria-live="polite" aria-atomic="true">Completion Progress: <span id="progressPercentage">0%</span></div>
            <div class="progress-bar-container" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Form completion progress">
                <div class="progress-bar-fill" id="progressBarFill"></div>
            </div>
            
            <div class="progress-steps" role="list" aria-label="Form steps">
                <div class="step active" id="step1Indicator" role="listitem" aria-current="step">
                    <div class="step-number" aria-hidden="true">1</div>
                    <div class="step-label">Personal<br>Details</div>
                </div>
                <div class="step" id="step2Indicator" role="listitem">
                    <div class="step-number" aria-hidden="true">2</div>
                    <div class="step-label">Additional<br>Details</div>
                </div>
            </div>

            <form id="eligibilityForm" aria-labelledby="formTitle">
                <div class="form-step active" id="step1">
                    <div class="form-group">
                        <label for="fullName">Full Name*</label>
                        <input type="text" id="fullName" required>
                        <div class="error-message" id="fullNameError">Please enter your full name</div>
                    </div>

                    <div class="form-group">
                        <label for="email">Email Address*</label>
                        <input type="email" id="email" placeholder="e.g., name@example.com" required>
                        <div class="error-message" id="emailError">Please enter a valid email address</div>
                    </div>

                    <div class="form-group">
                        <label for="phone">Phone Number*</label>
                        <input type="tel" id="phone" placeholder="e.g., 0712345678, 0112345678" required>
                        <div class="error-message" id="phoneError">Please enter a valid phone number</div>
                    </div>

                    <div class="form-group">
                        <label for="nationalId">National ID Number (8 or more digits)*</label>
                        <input type="text" id="nationalId" required minlength="8">
                        <div class="error-message" id="nationalIdError">Please enter a valid ID number (min 8 digits)</div>
                    </div>

                    <div class="form-group">
                        <label for="gender">Gender*</label>
                        <select id="gender" required>
                            <option value="">Select Gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Other</option>
                        </select>
                        <div class="error-message" id="genderError">Please select your gender</div>
                    </div>

                    <div class="form-group">
                        <label for="dob">Date of Birth*</label>
                        <input type="date" id="dob" required>
                        <div class="error-message" id="dobError">Please select your date of birth</div>
                    </div>

                    <div class="form-group">
                        <label for="maritalStatus">Marital Status*</label>
                        <select id="maritalStatus" required>
                            <option value="">Select Marital Status</option>
                            <option value="Single">Single</option>
                            <option value="Married">Married</option>
                            <option value="Divorced">Divorced</option>
                            <option value="Widowed">Widowed</option>
                        </select>
                        <div class="error-message" id="maritalStatusError">Please select your marital status</div>
                    </div>

                    <div class="form-group">
                        <label for="dependents">Number of Dependents*</label>
                        <select id="dependents" required>
                            <option value="">Select Number of Dependents</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5+">5 or more</option>
                        </select>
                        <div class="error-message" id="dependentsError">Please select number of dependents</div>
                    </div>

                    <div class="form-group">
                        <label for="residentialAddress">Residential Address*</label>
                        <input type="text" id="residentialAddress" placeholder="e.g., 123 Main Street, Nairobi" required>
                        <div class="error-message" id="residentialAddressError">Please enter your residential address</div>
                    </div>

                    <div class="button-group">
                        <button type="button" class="btn btn-back" onclick="window.location.href='index.html'">Back</button>
                        <button type="button" class="btn btn-next" onclick="nextStep()">Next</button>
                    </div>
                </div>

                <div class="form-step" id="step2">
                    <div class="form-group">
                        <label for="county">County of Residence*</label>
                        <input type="text" id="county" required>
                        <div class="error-message" id="countyError">Please enter your county</div>
                    </div>

                    <div class="form-group">
                        <label for="education">Level of Education*</label>
                        <select id="education" required>
                            <option value="">Select Education Level</option>
                            <option value="Primary">Primary</option>
                            <option value="Secondary">Secondary</option>
                            <option value="Certificate">Certificate</option>
                            <option value="Diploma">Diploma</option>
                            <option value="Degree">Degree</option>
                            <option value="Postgraduate">Postgraduate</option>
                        </select>
                        <div class="error-message" id="educationError">Please select your education level</div>
                    </div>

                    <div class="form-group">
                        <label for="employment">Employment Status*</label>
                        <select id="employment" required>
                            <option value="">Select Employment Status</option>
                            <option value="Unemployed">Unemployed</option>
                            <option value="Self-Employed">Self-Employed</option>
                            <option value="Employed">Employed</option>
                            <option value="Business Owner">Business Owner</option>
                        </select>
                        <div class="error-message" id="employmentError">Please select your employment status</div>
                    </div>

                    <div class="form-group">
                        <label for="employerName">Employer / Business Name*</label>
                        <input type="text" id="employerName" placeholder="e.g., ABC Company or Self-Employed" required>
                        <div class="error-message" id="employerNameError">Please enter your employer or business name</div>
                    </div>

                    <div class="form-group">
                        <label for="employmentDuration">Employment Duration*</label>
                        <select id="employmentDuration" required>
                            <option value="">Select Employment Duration</option>
                            <option value="Less than 6 months">Less than 6 months</option>
                            <option value="6 months - 1 year">6 months - 1 year</option>
                            <option value="1 - 2 years">1 - 2 years</option>
                            <option value="2 - 5 years">2 - 5 years</option>
                            <option value="5+ years">5+ years</option>
                        </select>
                        <div class="error-message" id="employmentDurationError">Please select your employment duration</div>
                    </div>

                    <div class="form-group">
                        <label for="incomeType">Type of Income*</label>
                        <select id="incomeType" required>
                            <option value="">Select Income Type</option>
                            <option value="Salary">Salary</option>
                            <option value="Business Income">Business Income</option>
                            <option value="Commission">Commission</option>
                            <option value="Freelance">Freelance</option>
                            <option value="Mixed Income">Mixed Income</option>
                            <option value="Other">Other</option>
                        </select>
                        <div class="error-message" id="incomeTypeError">Please select your income type</div>
                    </div>

                    <div class="form-group">
                        <label for="income">Monthly Income (KES)*</label>
                        <select id="income" required>
                            <option value="">Select Monthly Income</option>
                            <option value="0-10000">KES 0 - 10,000</option>
                            <option value="10000-20000">KES 10,000 - 20,000</option>
                            <option value="20000-35000">KES 20,000 - 35,000</option>
                            <option value="35000-50000">KES 35,000 - 50,000</option>
                            <option value="50000-100000">KES 50,000 - 100,000</option>
                            <option value="100000+">KES 100,000+</option>
                        </select>
                        <div class="error-message" id="incomeError">Please select your monthly income</div>
                    </div>

                    <div class="form-group">
                        <label for="monthlyExpenses">Monthly Expenses / Liabilities (KES)*</label>
                        <select id="monthlyExpenses" required>
                            <option value="">Select Monthly Expenses</option>
                            <option value="0-5000">KES 0 - 5,000</option>
                            <option value="5000-10000">KES 5,000 - 10,000</option>
                            <option value="10000-20000">KES 10,000 - 20,000</option>
                            <option value="20000-35000">KES 20,000 - 35,000</option>
                            <option value="35000-50000">KES 35,000 - 50,000</option>
                            <option value="50000+">KES 50,000+</option>
                        </select>
                        <div class="error-message" id="monthlyExpensesError">Please select your monthly expenses</div>
                    </div>

                    <div class="form-group">
                        <label for="loanAmount">Preferred Loan Amount (KES)*</label>
                        <select id="loanAmount" required>
                            <option value="">Select Loan Amount</option>
                            <option value="3500">KES 3,500</option>
                            <option value="5500">KES 5,500</option>
                            <option value="11800">KES 11,800</option>
                            <option value="15000">KES 15,000</option>
                            <option value="20000">KES 20,000</option>
                            <option value="25000">KES 25,000</option>
                            <option value="35000">KES 35,000</option>
                        </select>
                        <div class="error-message" id="loanAmountError">Please select your preferred loan amount</div>
                    </div>

                    <div class="form-group">
                        <label for="purpose">Loan Purpose*</label>
                        <select id="purpose" required>
                            <option value="">Select Loan Purpose</option>
                            <option value="Business">Business</option>
                            <option value="Education">Education</option>
                            <option value="Medical">Medical</option>
                            <option value="Personal">Personal</option>
                            <option value="Emergency">Emergency</option>
                            <option value="Other">Other</option>
                        </select>
                        <div class="error-message" id="purposeError">Please select loan purpose</div>
                    </div>

                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="consentCheckbox" required>
                            <span>I consent to the processing of my personal information for the purpose of this loan application and agree to be contacted regarding my application.*</span>
                        </label>
                        <div class="error-message" id="consentCheckboxError">You must provide consent to continue</div>
                    </div>

                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="privacyCheckbox" required>
                            <span>I acknowledge that I have read and understood the data privacy policy and agree to the terms and conditions of Techspace Finance.*</span>
                        </label>
                        <div class="error-message" id="privacyCheckboxError">You must acknowledge the data privacy policy</div>
                    </div>

                    <div class="button-group">
                        <button type="button" class="btn btn-back" onclick="prevStep()">Back</button>
                        <button type="submit" class="btn btn-submit">Submit</button>
                    </div>
                </div>

                <div class="form-step" id="successStep">
                    <div class="success-message">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin: 0 auto 1rem;">
                            <circle cx="12" cy="12" r="10" stroke="#22c55e" stroke-width="2"/>
                            <path d="M8 12L11 15L16 9" stroke="#22c55e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <p>Your eligibility check was successful! Please wait while we redirect you to the next step.</p>
                        <div class="spinner"></div>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div class="notification-box" id="notificationBox">
        <div class="notification-header">
            <div class="notification-title" id="notificationTitle">Notification</div>
            <span class="notification-close" onclick="closeNotification()">&times;</span>
        </div>
        <div class="notification-message" id="notificationMessage"></div>
        <ul class="notification-list" id="notificationList"></ul>
    </div>

    <div class="modal-overlay" id="submitModal">
        <div class="modal-content">
            <div class="modal-progress" id="modalProgress">
                <div class="modal-progress-text" style="margin-bottom: 1.5rem;">Processing Your Application</div>
                <div id="processingSteps">
                    <div class="processing-step" id="step-submit">
                        <div class="step-icon"></div>
                        <span>Submitting data to Techspace Limited</span>
                    </div>
                    <div class="processing-step" id="step-validate">
                        <div class="step-icon"></div>
                        <span>Validating information</span>
                    </div>
                    <div class="processing-step" id="step-analyze">
                        <div class="step-icon"></div>
                        <span>Analyzing eligibility criteria</span>
                    </div>
                    <div class="processing-step" id="step-calculate">
                        <div class="step-icon"></div>
                        <span>Calculating loan options</span>
                    </div>
                    <div class="processing-step" id="step-finalize">
                        <div class="step-icon"></div>
                        <span>Finalizing application</span>
                    </div>
                </div>
            </div>
            <div class="modal-progress" id="modalSuccess" style="display: none;">
                <svg class="checkmark-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" stroke="#22c55e" stroke-width="2" fill="none"/>
                    <path d="M8 12L11 15L16 9" stroke="#22c55e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <div class="modal-progress-text" style="color: #22c55e;">Application Completed!</div>
                <p style="margin-top: 1rem; color: #6b7280;">Redirecting you now...</p>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const formData = {};

        function calculateLoanOptions(employment, income, education) {
            const loanOptions = [];
            let baseAmount = 3500;
            
            const employmentMultiplier = {
                'Unemployed': 1,
                'Self-Employed': 1.5,
                'Employed': 2,
                'Business Owner': 2.5
            };

            const incomeMultiplier = {
                '0-10000': 1,
                '10000-20000': 1.5,
                '20000-35000': 2,
                '35000-50000': 2.5,
                '50000-100000': 3.5,
                '100000+': 5
            };

            const educationMultiplier = {
                'Primary': 1,
                'Secondary': 1.2,
                'Certificate': 1.4,
                'Diploma': 1.6,
                'Degree': 1.8,
                'Postgraduate': 2
            };

            const empMult = employmentMultiplier[employment] || 1;
            const incMult = incomeMultiplier[income] || 1;
            const eduMult = educationMultiplier[education] || 1;

            const maxLoan = Math.min(baseAmount * empMult * incMult * eduMult, 35000);

            const amounts = [3500, 5500, 11800, 15000, 20000, 25000, 35000];
            
            for (let amount of amounts) {
                if (amount <= maxLoan) {
                    const serviceFee = Math.round(amount * 0.03);
                    loanOptions.push({
                        amount: amount,
                        interestRate: 7,
                        serviceFee: serviceFee,
                        repaymentPeriod: 61,
                        trackingNumber: generateTrackingNumber()
                    });
                }
            }

            return loanOptions;
        }

        function generateTrackingNumber() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0;
                const v = c === 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }

        function validateStep1() {
            let isValid = true;
            const errors = [];
            let firstErrorField = null;
            
            const fullName = document.getElementById('fullName');
            if (!fullName.value.trim()) {
                showError('fullName');
                errors.push('Full Name is required');
                if (!firstErrorField) firstErrorField = fullName;
                isValid = false;
            } else {
                hideError('fullName');
            }

            const email = document.getElementById('email');
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email.value)) {
                showError('email');
                errors.push('Valid Email Address is required');
                if (!firstErrorField) firstErrorField = email;
                isValid = false;
            } else {
                hideError('email');
            }

            const phone = document.getElementById('phone');
            const phoneRegex = /^(07|01)\d{8}$/;
            if (!phoneRegex.test(phone.value.replace(/\s/g, ''))) {
                showError('phone');
                errors.push('Valid Phone Number is required (e.g., 0712345678)');
                if (!firstErrorField) firstErrorField = phone;
                isValid = false;
            } else {
                hideError('phone');
            }

            const nationalId = document.getElementById('nationalId');
            if (nationalId.value.length < 8) {
                showError('nationalId');
                errors.push('National ID must be at least 8 digits');
                if (!firstErrorField) firstErrorField = nationalId;
                isValid = false;
            } else {
                hideError('nationalId');
            }

            const gender = document.getElementById('gender');
            if (!gender.value) {
                showError('gender');
                errors.push('Gender is required');
                if (!firstErrorField) firstErrorField = gender;
                isValid = false;
            } else {
                hideError('gender');
            }

            const dob = document.getElementById('dob');
            if (!dob.value) {
                showError('dob');
                errors.push('Date of Birth is required');
                if (!firstErrorField) firstErrorField = dob;
                isValid = false;
            } else {
                const age = calculateAge(dob.value);
                if (age < 18) {
                    showError('dob');
                    document.getElementById('dobError').textContent = 'You must be at least 18 years old';
                    errors.push('You must be at least 18 years old');
                    if (!firstErrorField) firstErrorField = dob;
                    isValid = false;
                } else {
                    hideError('dob');
                }
            }

            const maritalStatus = document.getElementById('maritalStatus');
            if (!maritalStatus.value) {
                showError('maritalStatus');
                errors.push('Marital Status is required');
                if (!firstErrorField) firstErrorField = maritalStatus;
                isValid = false;
            } else {
                hideError('maritalStatus');
            }

            const dependents = document.getElementById('dependents');
            if (!dependents.value) {
                showError('dependents');
                errors.push('Number of Dependents is required');
                if (!firstErrorField) firstErrorField = dependents;
                isValid = false;
            } else {
                hideError('dependents');
            }

            const residentialAddress = document.getElementById('residentialAddress');
            if (!residentialAddress.value.trim()) {
                showError('residentialAddress');
                errors.push('Residential Address is required');
                if (!firstErrorField) firstErrorField = residentialAddress;
                isValid = false;
            } else {
                hideError('residentialAddress');
            }

            if (!isValid) {
                showNotification('error', 'Please fix the following errors:', errors);
                if (firstErrorField) {
                    firstErrorField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    setTimeout(() => firstErrorField.focus(), 500);
                }
            }

            return isValid;
        }

        function validateStep2() {
            let isValid = true;
            const errors = [];
            let firstErrorField = null;
            
            const fieldNames = {
                'county': 'County of Residence',
                'education': 'Level of Education',
                'employment': 'Employment Status',
                'employerName': 'Employer/Business Name',
                'employmentDuration': 'Employment Duration',
                'incomeType': 'Type of Income',
                'income': 'Monthly Income',
                'monthlyExpenses': 'Monthly Expenses',
                'loanAmount': 'Preferred Loan Amount',
                'purpose': 'Loan Purpose'
            };

            const fields = ['county', 'education', 'employment', 'employerName', 'employmentDuration', 'incomeType', 'income', 'monthlyExpenses', 'loanAmount', 'purpose'];
            fields.forEach(field => {
                const element = document.getElementById(field);
                if (!element.value) {
                    showError(field);
                    errors.push(fieldNames[field] + ' is required');
                    if (!firstErrorField) firstErrorField = element;
                    isValid = false;
                } else {
                    hideError(field);
                }
            });

            const consentCheckbox = document.getElementById('consentCheckbox');
            if (!consentCheckbox.checked) {
                document.getElementById('consentCheckboxError').style.display = 'block';
                errors.push('You must provide consent to continue');
                isValid = false;
            } else {
                document.getElementById('consentCheckboxError').style.display = 'none';
            }

            const privacyCheckbox = document.getElementById('privacyCheckbox');
            if (!privacyCheckbox.checked) {
                document.getElementById('privacyCheckboxError').style.display = 'block';
                errors.push('You must acknowledge the data privacy policy');
                isValid = false;
            } else {
                document.getElementById('privacyCheckboxError').style.display = 'none';
            }

            if (!isValid) {
                showNotification('error', 'Please fix the following errors:', errors);
                if (firstErrorField) {
                    firstErrorField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    setTimeout(() => firstErrorField.focus(), 500);
                }
            }

            return isValid;
        }

        function showNotification(type, title, errors) {
            const notificationBox = document.getElementById('notificationBox');
            const notificationTitle = document.getElementById('notificationTitle');
            const notificationMessage = document.getElementById('notificationMessage');
            const notificationList = document.getElementById('notificationList');

            notificationBox.className = 'notification-box show ' + type;
            notificationTitle.textContent = type === 'error' ? 'Validation Error' : 'Success';
            
            if (Array.isArray(errors) && errors.length > 0) {
                notificationMessage.textContent = title;
                notificationList.innerHTML = errors.map(err => `<li>${err}</li>`).join('');
                notificationList.style.display = 'block';
            } else {
                notificationMessage.textContent = title;
                notificationList.innerHTML = '';
                notificationList.style.display = 'none';
            }

            setTimeout(() => {
                closeNotification();
            }, 8000);
        }

        function closeNotification() {
            const notificationBox = document.getElementById('notificationBox');
            notificationBox.classList.remove('show');
        }

        function showError(fieldId) {
            document.getElementById(fieldId).classList.add('error');
            document.getElementById(fieldId + 'Error').style.display = 'block';
        }

        function hideError(fieldId) {
            document.getElementById(fieldId).classList.remove('error');
            document.getElementById(fieldId + 'Error').style.display = 'none';
        }

        function calculateAge(birthDate) {
            const today = new Date();
            const birth = new Date(birthDate);
            let age = today.getFullYear() - birth.getFullYear();
            const monthDiff = today.getMonth() - birth.getMonth();
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
                age--;
            }
            return age;
        }

        function calculateProgress() {
            const allFields = [
                'fullName', 'email', 'phone', 'nationalId', 'gender', 'dob', 'maritalStatus', 'dependents', 'residentialAddress',
                'county', 'education', 'employment', 'employerName', 'employmentDuration', 'incomeType', 'income', 'monthlyExpenses', 'loanAmount', 'purpose'
            ];
            
            let filledFields = 0;
            allFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field && field.value && field.value.trim() !== '') {
                    filledFields++;
                }
            });

            const consentCheckbox = document.getElementById('consentCheckbox');
            const privacyCheckbox = document.getElementById('privacyCheckbox');
            if (consentCheckbox && consentCheckbox.checked) filledFields++;
            if (privacyCheckbox && privacyCheckbox.checked) filledFields++;

            const totalFields = allFields.length + 2;
            const percentage = Math.round((filledFields / totalFields) * 100);
            
            document.getElementById('progressBarFill').style.width = percentage + '%';
            document.getElementById('progressPercentage').textContent = percentage + '%';
        }

        function nextStep() {
            if (validateStep1()) {
                formData.fullName = document.getElementById('fullName').value;
                formData.email = document.getElementById('email').value;
                formData.phone = document.getElementById('phone').value;
                formData.nationalId = document.getElementById('nationalId').value;
                formData.gender = document.getElementById('gender').value;
                formData.dob = document.getElementById('dob').value;
                formData.maritalStatus = document.getElementById('maritalStatus').value;
                formData.dependents = document.getElementById('dependents').value;
                formData.residentialAddress = document.getElementById('residentialAddress').value;
                formData.currentStep = 2;

                localStorage.setItem('loanApplication', JSON.stringify(formData));

                document.getElementById('step1').classList.remove('active');
                document.getElementById('step2').classList.add('active');
                document.getElementById('step1Indicator').classList.add('completed');
                document.getElementById('step2Indicator').classList.add('active');
                currentStep = 2;

                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function prevStep() {
            document.getElementById('step2').classList.remove('active');
            document.getElementById('step1').classList.add('active');
            document.getElementById('step1Indicator').classList.remove('completed');
            document.getElementById('step2Indicator').classList.remove('active');
            currentStep = 1;

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        document.getElementById('eligibilityForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (validateStep2()) {
                formData.county = document.getElementById('county').value;
                formData.education = document.getElementById('education').value;
                formData.employment = document.getElementById('employment').value;
                formData.employerName = document.getElementById('employerName').value;
                formData.employmentDuration = document.getElementById('employmentDuration').value;
                formData.incomeType = document.getElementById('incomeType').value;
                formData.income = document.getElementById('income').value;
                formData.monthlyExpenses = document.getElementById('monthlyExpenses').value;
                formData.loanAmount = document.getElementById('loanAmount').value;
                formData.purpose = document.getElementById('purpose').value;
                formData.currentStep = 'completed';

                const loanOptions = calculateLoanOptions(formData.employment, formData.income, formData.education);
                formData.loanOptions = loanOptions;
                formData.maxLoan = loanOptions.length > 0 ? loanOptions[loanOptions.length - 1].amount : 3500;

                localStorage.setItem('loanApplication', JSON.stringify(formData));

                showSubmitModal();
            }
        });

        function showSubmitModal() {
            const modal = document.getElementById('submitModal');
            const modalProgress = document.getElementById('modalProgress');
            const modalSuccess = document.getElementById('modalSuccess');
            
            modal.classList.add('active');
            modalProgress.style.display = 'block';
            modalSuccess.style.display = 'none';
            
            const processingSteps = [
                { id: 'step-submit', duration: 1500 },
                { id: 'step-validate', duration: 2000 },
                { id: 'step-analyze', duration: 1800 },
                { id: 'step-calculate', duration: 1500 },
                { id: 'step-finalize', duration: 1200 }
            ];
            
            let currentStepIndex = 0;
            
            function processNextStep() {
                if (currentStepIndex < processingSteps.length) {
                    const step = processingSteps[currentStepIndex];
                    const stepElement = document.getElementById(step.id);
                    
                    stepElement.classList.add('active');
                    
                    setTimeout(() => {
                        stepElement.classList.remove('active');
                        stepElement.classList.add('completed');
                        currentStepIndex++;
                        processNextStep();
                    }, step.duration);
                } else {
                    setTimeout(() => {
                        modalProgress.style.display = 'none';
                        modalSuccess.style.display = 'block';
                        
                        setTimeout(() => {
                            window.location.href = 'loan-options.html';
                        }, 2000);
                    }, 500);
                }
            }
            
            processNextStep();
        }

        function validateFieldLive(fieldId, validationFn) {
            const field = document.getElementById(fieldId);
            if (!field) return;

            field.addEventListener('blur', function() {
                if (validationFn(field.value)) {
                    hideError(fieldId);
                    field.classList.add('valid');
                } else {
                    if (field.value.trim() !== '') {
                        showError(fieldId);
                        field.classList.remove('valid');
                    }
                }
            });

            field.addEventListener('input', function() {
                if (validationFn(field.value)) {
                    hideError(fieldId);
                    field.classList.add('valid');
                } else {
                    field.classList.remove('valid');
                }
            });
        }

        function setupLiveValidation() {
            validateFieldLive('fullName', (val) => val.trim().length > 0);
            validateFieldLive('email', (val) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(val));
            validateFieldLive('phone', (val) => /^(07|01)\d{8}$/.test(val.replace(/\s/g, '')));
            validateFieldLive('nationalId', (val) => val.length >= 8);
            validateFieldLive('residentialAddress', (val) => val.trim().length > 0);
            validateFieldLive('county', (val) => val.trim().length > 0);
            validateFieldLive('employerName', (val) => val.trim().length > 0);

            const selectFields = ['gender', 'maritalStatus', 'dependents', 'education', 'employment', 
                                 'employmentDuration', 'incomeType', 'income', 'monthlyExpenses', 
                                 'loanAmount', 'purpose'];
            
            selectFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.addEventListener('change', function() {
                        if (field.value) {
                            hideError(fieldId);
                            field.classList.add('valid');
                        } else {
                            field.classList.remove('valid');
                        }
                    });
                }
            });

            const dobField = document.getElementById('dob');
            if (dobField) {
                dobField.addEventListener('change', function() {
                    if (dobField.value) {
                        const age = calculateAge(dobField.value);
                        if (age >= 18) {
                            hideError('dob');
                            dobField.classList.add('valid');
                        } else {
                            showError('dob');
                            document.getElementById('dobError').textContent = 'You must be at least 18 years old';
                            dobField.classList.remove('valid');
                        }
                    }
                });
            }

            const checkboxes = ['consentCheckbox', 'privacyCheckbox'];
            checkboxes.forEach(checkboxId => {
                const checkbox = document.getElementById(checkboxId);
                if (checkbox) {
                    checkbox.addEventListener('change', function() {
                        if (checkbox.checked) {
                            document.getElementById(checkboxId + 'Error').style.display = 'none';
                        }
                    });
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            setupLiveValidation();
            
            const formInputs = document.querySelectorAll('input, select');
            formInputs.forEach(input => {
                input.addEventListener('input', calculateProgress);
                input.addEventListener('change', calculateProgress);
            });

            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', calculateProgress);
            });

            calculateProgress();
        });

        window.addEventListener('load', () => {
            const savedData = localStorage.getItem('loanApplication');
            if (savedData) {
                const data = JSON.parse(savedData);
                
                if (data.currentStep === 2) {
                    document.getElementById('fullName').value = data.fullName || '';
                    document.getElementById('email').value = data.email || '';
                    document.getElementById('phone').value = data.phone || '';
                    document.getElementById('nationalId').value = data.nationalId || '';
                    document.getElementById('gender').value = data.gender || '';
                    document.getElementById('dob').value = data.dob || '';
                    document.getElementById('maritalStatus').value = data.maritalStatus || '';
                    document.getElementById('dependents').value = data.dependents || '';
                    document.getElementById('residentialAddress').value = data.residentialAddress || '';
                    
                    nextStep();
                } else if (data.currentStep === 'completed') {
                    window.location.href = 'loan-options.html';
                } else {
                    document.getElementById('fullName').value = data.fullName || '';
                    document.getElementById('email').value = data.email || '';
                    document.getElementById('phone').value = data.phone || '';
                    document.getElementById('nationalId').value = data.nationalId || '';
                    document.getElementById('gender').value = data.gender || '';
                    document.getElementById('dob').value = data.dob || '';
                    document.getElementById('maritalStatus').value = data.maritalStatus || '';
                    document.getElementById('dependents').value = data.dependents || '';
                    document.getElementById('residentialAddress').value = data.residentialAddress || '';
                }
            }
            
            calculateProgress();
        });
    </script>
</body>
</html>
